# Generated by sgnl-test-init â€” fill in the TODOs below
#
# Scenarios with "record: true" will be recorded by: npx sgnl-test-record
# Fill in real secrets in action.context.secrets, then run the recorder.
# After recording, redact secrets before committing.
action:
  params:
    subject: "{\"format\": \"email\", \"email\": \"alice@example.com\"}"
    audience: https://audience.example.com
    namespace: NIST-AAL
    current_level: test-current_level
    previous_level: test-previous_level
    change_direction: test-change_direction
    initiating_entity: test-initiating_entity
    reason_admin: test-reason_admin
    reason_user: test-reason_user
    address: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
  context:
    secrets:
      BEARER_AUTH_TOKEN: auth-token
    environment: {}
    crypto:
      signJWT:
        returns: eyJhbGciOiJSUzI1NiIsImtpZCI6IjllMjJlMjc2LWQzYTQtNGE2OS1hZDA4LWQyNmNmNWI0Y2ExOSIsInR5cCI6InNlY2V2ZW50K2p3dCJ9.eyJhdWQiOiJodHRwczovL3d3dy50ZXN0LmNvbSIsImV2ZW50cyI6eyJodHRwczovL3NjaGVtYXMub3BlbmlkLm5ldC9zZWNldmVudC9jYWVwL2V2ZW50LXR5cGUvYXNzdXJhbmNlLWxldmVsLWNoYW5nZSI6eyJjdXJyZW50TGV2ZWwiOiJ0ZXN0LWxldmVsIiwiZXZlbnRfdGltZXN0YW1wIjoxNzcyMjM3MTg1LCJuYW1lc3BhY2UiOiJOSVNULUFBTCIsInN1YmplY3QiOnsiZW1haWwiOiJ0ZXN0QHRlc3QuY29tIiwiZm9ybWF0IjoiZW1haWwifX19LCJpYXQiOjE3NzIyMzcxODUsImlzcyI6Imh0dHBzOi8vc3NmLmNhZXAuZGV2LyIsImp0aSI6IllXUTBZelZpWmprdFptSmtNaTAwTVRjNUxXRmhNV0l0TURGaVptRTJaV1V5TW1RNSIsInN1Yl9pZCI6eyJlbWFpbCI6InRlc3RAdGVzdC5jb20iLCJmb3JtYXQiOiJlbWFpbCJ9fQ.WXn6uAXMuDGdlU1TsKKD-w3XWGr1lJeoiyqviOwYcbj_xThXuP972nuZDResFyIEavGdslC5Q4MBUm9EVPwMv-f-FsuzoXhYA6uTu-qUwLJZcBfNdsq8f6ijOSvTPcSu_-w-GOZZaJyoXnP_79BM-Ly-s6pHMmyrLoPOzvhnzkXvRQtGHf7d-CnqTyJIHwTbDHE_2qXrJk-wdnJuXfwbV607DnsnBwWqZwZ4c2BTMbUlCduKKPmMqbNafUQMb8_CDFDIr1cSlmxuQstAm-z22rHxPtlMlFgAbdbQFJRZ1qoMeVxZOyiupD8GiQzsYCw0YzUMYFYdcvvq0GMOdUmx6g
scenarios:
  - name: Base Success Case
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/base-success-case.http
    invoke:
      returns:
        status: success
        statusCode: 202
        body: ""
        headers:
          content-length: "0"
          date: Sat, 28 Feb 2026 00:12:33 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "7"
          x-request-id: 77f56b65-ccda-4107-9e36-be12e1490b4c
          x-sgnl-istio-vs: sgnlapis-cloud-events
  - name: Duplicate Event
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/duplicate-event.http
    invoke:
      returns:
        status: failed
        statusCode: 409
        body:
          err: duplicate_event
          description: Failed to store the event. The event already exists.
        headers:
          content-length: "95"
          content-type: application/json
          date: Sat, 28 Feb 2026 00:14:11 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "12"
          x-request-id: c76595f7-844b-4a1a-9d6d-0f1ec74fb9a6
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 409: Conflict"
        retryable: false
  - name: Invalid token
    context:
      secrets:
        BEARER_AUTH_TOKEN: invalid-token
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/invalid-token.http
    invoke:
      returns:
        status: failed
        statusCode: 400
        body:
          err: authentication_failed
          description: The SET Recipient could not authenticate the SET Transmitter.
        headers:
          content-length: "110"
          content-type: application/json
          date: Sat, 28 Feb 2026 00:15:12 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "6"
          x-request-id: d8b185bf-a6bf-4d60-b34a-fde679e07e76
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 400: Bad Request"
        retryable: false
